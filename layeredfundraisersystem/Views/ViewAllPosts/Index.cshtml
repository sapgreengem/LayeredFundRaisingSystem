@{
    ViewBag.Title = "Index";
    if (Session["Login"] == null)
    {
        Layout = "~/Views/Shared/_ViewersLayout.cshtml";
    }
    else
    {
        Layout = "~/Views/Shared/_UserLayout.cshtml";
    }
}


<div class="container">
    <div class="row">

        @*<div class="col-md-8 col-md-offset-2">*@
            <div>
                <form method="post" name="cat">
                    <div style="float:left">
                        Find by Category
                        <select name="Category" onchange="this.form.submit()">
                            @foreach (var ListItem in ViewBag.Categories)
                            {
                                <option value="@ListItem.CategoryId">@ListItem.CategoryName</option>
                            }
                        </select>
                    </div>
                </form>
                <form method="post" name="search">
                    <div class="pull-right">
                        Search By Name
                        <input type="text" name="searchName" id="searchName" />
                        <button type="submit"><i class="glyphicon glyphicon-search"></i></button><br />
                        <span id="error_searchName" class="text-danger"></span>
                    </div>
                </form>
            </div>

            <br />
            <br />

            <table class="table">
                @foreach (var item in ViewBag.Posts)
                {
                    <tr>
                        <td>
                            <a style="color:black;" href="/PostDetailsView/Index/@item.PostId" title="Click To View">
                                <img src="~/PostImages/@item.PostImage" alt="N/A" style="width:300px; height:150px">
                                <div class="progress" style="width:300px">
                                    <div class="progress-bar-success text-center" role="progressbar" aria-valuenow="70"
                                         aria-valuemin="0" aria-valuemax="100" style="width:@((item.CollectedAmount / item.RequiredAmount)*100)%; color:White">
                                        @Convert.ToInt32(((item.CollectedAmount / item.RequiredAmount) * 100))%
                                    </div>
                                </div>
                            </a>
                        </td>
                        <td>
                            <a style="color:black;" href="/PostDetailsView/Index/@item.PostId" title="Click To View">
                                <h4>@item.PostTitle</h4>
                            </a>
                            <p style="height:80px; overflow:hidden; text-align:justify">@item.PostDetails</p>
                            <a class="pull-right" href="/PostDetailsView/Index/@item.PostId">Details</a>
                        </td>
                        <td style="vertical-align:middle; text-align:center; width:15%">
                            <h5>Targeted @item.RequiredAmount/=</h5>
                            <h5>Raised @item.CollectedAmount/=</h5>

                            @if (item.UserInformationId != Convert.ToInt32(Session["UserInformationId"]) || Session["UserInformationId"] == null)
                            {
                                //Session["DonateNowPostID"] = @item.PostId;
                                <a class="btn btn-default" href="/DonateOnPost/Index/@item.PostId">Donate Now</a>
                            }
                        </td>
                    </tr>
                }
            </table>
        @*</div>*@

    </div>
</div>

<script type="text/javascript">
    $(function () {

        $("#searchName").keyup(function () {
            $("#error_searchName").html("");
            $.ajax({
                url: '@Url.Action("VerifyEmail", "UserRegistration")',
                dataType: "json",
                type: "GET",
                contentType: 'application/json; charset=utf-8',
                async: true,
                data: { id: $("#email").val() },
                success: function (response) {
                    $('#error_message').html(response.message);
                }
            });
        });

        $(document).on("submit", "form", function (e) {

            if ($("#searchName").val() == "")
            {
                $("#error_searchName").html("Type something here.");
                e.preventDefault();
                return false;
            }

             

            else
            {
                $("#error_searchName").html("");
                return true;
            }
        });
    });
</script>